2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Current SDK version is 0.15.4
2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Configure stats pid to 120373
2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Loading settings from /home/jstav/.config/wandb/settings
2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Loading settings from /home/jstav/Documents/stanford/Spring 2023/Stabekov-LM/improved-diffusion/wandb/settings
2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-06-08 15:02:14,032 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-06-08 15:02:14,033 INFO    MainThread:120373 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'improved-diffusion/scripts/train.py', 'program': 'scripts/train.py'}
2023-06-08 15:02:14,033 INFO    MainThread:120373 [wandb_init.py:_log_setup():507] Logging user logs to /home/jstav/Documents/stanford/Spring 2023/Stabekov-LM/improved-diffusion/wandb/run-20230608_150214-laqatp7n/logs/debug.log
2023-06-08 15:02:14,033 INFO    MainThread:120373 [wandb_init.py:_log_setup():508] Logging internal logs to /home/jstav/Documents/stanford/Spring 2023/Stabekov-LM/improved-diffusion/wandb/run-20230608_150214-laqatp7n/logs/debug-internal.log
2023-06-08 15:02:14,034 INFO    MainThread:120373 [wandb_init.py:init():547] calling init triggers
2023-06-08 15:02:14,034 INFO    MainThread:120373 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2023-06-08 15:02:14,034 INFO    MainThread:120373 [wandb_init.py:init():596] starting backend
2023-06-08 15:02:14,035 INFO    MainThread:120373 [wandb_init.py:init():600] setting up manager
2023-06-08 15:02:14,041 INFO    MainThread:120373 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-06-08 15:02:14,048 INFO    MainThread:120373 [wandb_init.py:init():606] backend started and connected
2023-06-08 15:02:14,054 INFO    MainThread:120373 [wandb_init.py:init():703] updated telemetry
2023-06-08 15:02:14,088 INFO    MainThread:120373 [wandb_init.py:init():736] communicating run to backend with 60.0 second timeout
2023-06-08 15:02:14,326 INFO    MainThread:120373 [wandb_run.py:_on_init():2176] communicating current version
2023-06-08 15:02:14,405 INFO    MainThread:120373 [wandb_run.py:_on_init():2185] got version response 
2023-06-08 15:02:14,405 INFO    MainThread:120373 [wandb_init.py:init():787] starting run threads in backend
2023-06-08 15:02:14,543 INFO    MainThread:120373 [wandb_run.py:_console_start():2155] atexit reg
2023-06-08 15:02:14,544 INFO    MainThread:120373 [wandb_run.py:_redirect():2010] redirect: SettingsConsole.WRAP_RAW
2023-06-08 15:02:14,544 INFO    MainThread:120373 [wandb_run.py:_redirect():2075] Wrapping output streams.
2023-06-08 15:02:14,544 INFO    MainThread:120373 [wandb_run.py:_redirect():2100] Redirects installed.
2023-06-08 15:02:14,545 INFO    MainThread:120373 [wandb_init.py:init():828] run started, returning control to user process
2023-06-08 15:02:14,556 INFO    MainThread:120373 [wandb_run.py:_config_callback():1283] config_cb None None {'data_dir': '', 'schedule_sampler': 'uniform', 'lr': 0.0001, 'weight_decay': 0.0, 'lr_anneal_steps': 400000, 'batch_size': 64, 'microbatch': -1, 'ema_rate': '0.9999', 'log_interval': 50, 'save_interval': 50000, 'resume_checkpoint': '', 'use_fp16': False, 'fp16_scale_growth': 0.001, 'seed': 101, 'gradient_clipping': -1.0, 'eval_interval': 2000, 'checkpoint_path': 'diffusion_models/diff_roc_pad_bert128_transformer_lr0.0001_0.0_2000_sqrt_Lsimple_h128_s2_d0.1_sd101_xstart_e2e', 'image_size': 8, 'num_channels': 128, 'num_res_blocks': 2, 'num_heads': 4, 'num_heads_upsample': -1, 'attention_resolutions': '16,8', 'dropout': 0.1, 'learn_sigma': False, 'sigma_small': False, 'class_cond': False, 'diffusion_steps': 2000, 'noise_schedule': 'sqrt', 'timestep_respacing': '', 'use_kl': False, 'predict_xstart': True, 'rescale_timesteps': True, 'rescale_learned_sigmas': True, 'use_checkpoint': False, 'use_scale_shift_norm': True, 'model_arch': 'transformer', 'in_channel': 128, 'out_channel': 128, 'training_mode': 'e2e', 'vocab_size': 11043, 'config_name': 'bert-base-uncased', 'experiment_mode': 'lm', 'logits_mode': 1, 'modality': 'roc', 'dataset_name': 'wikitext', 'dataset_config_name': 'wikitext-2-raw-v1', 'config': 'diffusion_lm/synthetic_data/configs/emnlp2020/experiments/difflm_seed0_m3_k128_trainc20000.yaml', 'model_name_or_path': 'predictability/diff_models/compress_e=5_b=60_m=gpt2_wikitext-103-raw-v1_None', 'experiment': 'bert', 'roc_train': '../datasets/ROCstory', 'wiki_train': 'diffusion_lm/simple_wiki/data.v1.split/simple.training.txt', 'e2e_train': 'e2e_data', 'yelp_train': 'diffusion_lm/yelpnlg-resources/yelpnlg-corpus', 'commonGen_train': 'diffusion_lm/common-gen/commongen_data', 'emb_scale_factor': 1.0, 'noise_level': 0.0, 'cache_mode': 'no', 'use_bert_tokenizer': 'no', 'padding_mode': 'pad', 'preprocessing_num_workers': 1}
2023-06-08 15:02:43,344 WARNING MsgRouterThr:120373 [router.py:message_loop():77] message_loop has been closed
